<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description"
        content="Converts Markdown formatting into Slack-compatible text with HTML clipboard support for pasting into Slack, Google Docs, and other applications.">
    <title>Slack Formatter</title>
    <style>
        * {
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", "Helvetica Neue", Arial, sans-serif;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            color: #000000;
            background-color: #fafaf9;
            line-height: 1.7;
            font-size: 16px;

            /* Clean font rendering */
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
            text-rendering: optimizeLegibility;
        }

        .window {
            background: #ffffff;
            border: 1px solid #d4d4d4;
            border-radius: 4px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1), 0 1px 2px rgba(0, 0, 0, 0.06);
            padding: 2rem;
        }

        h1 {
            margin-bottom: 0.5rem;
            font-size: 1.6rem;
            font-weight: 600;
        }

        .subtitle {
            color: #333333;
            font-size: 1rem;
            margin-bottom: 1.5rem;
        }

        .container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 20px;
            align-items: start;
        }

        @media (max-width: 768px) {
            .container {
                grid-template-columns: 1fr;
            }

            body {
                font-size: 12px;
                padding: 15px;
            }
        }

        .panel {
            display: flex;
            flex-direction: column;
            height: 100%;
        }

        .panel-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 10px;
            min-height: 40px;
        }

        .panel-title {
            font-weight: bold;
            font-size: 1.1rem;
            padding-top: 0.25rem;
        }

        textarea {
            width: 100%;
            min-height: 400px;
            padding: 15px;
            border: 2px inset #999;
            background: #ffffff;
            font-family: ui-monospace, "SF Mono", Menlo, "Courier New", monospace;
            font-size: 1rem;
            resize: vertical;
            line-height: 1.5;
        }

        textarea:focus {
            outline: none;
        }

        .preview {
            min-height: 400px;
            padding: 15px;
            border: 2px inset #999;
            background-color: #ffffff;
            white-space: pre-wrap;
            word-wrap: break-word;
            font-family: ui-monospace, "SF Mono", Menlo, "Courier New", monospace;
            font-size: 1rem;
            line-height: 1.6;
            overflow-y: auto;
        }

        .preview.empty {
            color: #555555;
        }

        button {
            background-color: #e7e5e4;
            color: #000000;
            border: 1px solid #d4d4d4;
            padding: 0.5rem 1.5rem;
            cursor: pointer;
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", "Helvetica Neue", Arial, sans-serif;
            font-size: 1rem;
            border-radius: 2px;
        }

        button:hover {
            background-color: #000000;
            color: #ffffff;
        }

        button:active {
            transform: translateY(1px);
        }

        button.copy-btn {
            background-color: #c96d5b;
            color: #ffffff;
            border-color: #c96d5b;
        }

        button.copy-btn:hover {
            background-color: #b85d4b;
        }

        button.copy-btn.copied {
            background-color: #00aa00;
        }

        .actions {
            display: flex;
            gap: 10px;
            margin-top: 10px;
        }

        .info-box {
            background-color: #ffffff;
            border: 2px inset #999;
            padding: 1rem;
            margin-bottom: 1.5rem;
            color: #000000 !important;
            font-weight: bold;
        }

        .info-box p {
            margin: 0.5rem 0;
        }

        .info-box code {
            background-color: #eeeeee;
            padding: 0.2em 0.4em;
            border: 1px solid #999;
            font-family: "Courier New", monospace;
            font-size: 1.1em;
            color: #000000 !important;
            font-weight: bold;
        }

        a {
            color: #0000ee;
            text-decoration: underline;
        }

        a:visited {
            color: #551a8b;
        }

        a:hover {
            background: #000080;
            color: #fff;
            text-decoration: none;
            padding: 0 2px;
            margin: 0 -2px;
        }

        .back-link {
            margin-bottom: 2rem;
        }

        .back-link a {
            color: #000000;
            text-decoration: none;
            background: #e7e5e4;
            border: 1px solid #d4d4d4;
            padding: 0.5rem 1rem;
            display: inline-block;
            border-radius: 2px;
        }

        .back-link a:hover {
            background: #000000;
            color: #ffffff;
        }
    </style>
    <meta name="keywords" content="Markdown, Slack, Text Conversion, Utilities, Clipboard">
</head>

<body>
    <div class="window">
        <div class="back-link">
            <a href="/tools.html">← Back to Tools</a>
        </div>

        <h1>Slack Formatter</h1>
        <p class="subtitle">Convert Markdown to Slack-compatible formatting</p>

        <div class="info-box">
            <p>Click "Copy HTML" to copy formatted text. HTML clipboard format works when pasting into Slack, Google
                Docs, and other apps that recognize HTML.</p>
        </div>

        <div class="container">
            <div class="panel">
                <div class="panel-header">
                    <span class="panel-title">Markdown Input</span>
                </div>
                <textarea id="markdownInput" placeholder="Paste or type your Markdown here...

Example:
# Heading
**Bold text** and *italic text*
- List item 1
- List item 2

\`code\` and code blocks

> Blockquote"></textarea>
            </div>

            <div class="panel">
                <div class="panel-header">
                    <span class="panel-title">Formatted Output</span>
                    <div style="display: flex; gap: 8px;">
                        <button class="copy-btn" id="copyHtmlBtn" onclick="copyAsHTML()"
                            title="Copy as HTML (works in Slack, Google Docs, etc.)">Copy HTML</button>
                        <button class="copy-btn" id="copyBtn" onclick="copyToClipboard()"
                            style="background-color: #808080;" title="Copy as plain text">Copy Text</button>
                    </div>
                </div>
                <div class="preview empty" id="slackOutput">Slack-formatted text will appear here...</div>
            </div>
        </div>

        <div class="actions">
            <button onclick="clearAll()">Clear All</button>
            <button onclick="loadExample()">Load Example</button>
        </div>
    </div>

    <script>
        const markdownInput = document.getElementById('markdownInput');
        const slackOutput = document.getElementById('slackOutput');
        const copyBtn = document.getElementById('copyBtn');

        markdownInput.addEventListener('input', convertMarkdownToSlack);

        function convertMarkdownToSlack() {
            const markdown = markdownInput.value;

            if (!markdown.trim()) {
                slackOutput.textContent = 'Slack-formatted text will appear here...';
                slackOutput.classList.add('empty');
                return;
            }

            slackOutput.classList.remove('empty');

            let slack = markdown;

            // First, protect code blocks and inline code from conversion
            const codeBlocks = [];
            const inlineCodes = [];

            // Store code blocks
            slack = slack.replace(/```[\s\S]*?```/g, (match) => {
                codeBlocks.push(match);
                return `__CODEBLOCK_${codeBlocks.length - 1}__`;
            });

            // Store inline code
            slack = slack.replace(/`[^`]+`/g, (match) => {
                inlineCodes.push(match);
                return `__INLINECODE_${inlineCodes.length - 1}__`;
            });

            // Convert headers (remove # syntax, make bold)
            slack = slack.replace(/^### (.*$)/gim, '*$1*');
            slack = slack.replace(/^## (.*$)/gim, '*$1*');
            slack = slack.replace(/^# (.*$)/gim, '*$1*');

            // Convert bold **text** to *text* (Slack uses single asterisk for bold)
            // Use a placeholder to avoid conflicts
            const boldPlaceholders = [];
            slack = slack.replace(/\*\*(.+?)\*\*/g, (match, content) => {
                boldPlaceholders.push(content);
                return `__BOLD_${boldPlaceholders.length - 1}__`;
            });

            // Convert italic *text* to _text_ (Slack uses underscore for italic)
            slack = slack.replace(/\*([^*\n]+?)\*/g, '_$1_');

            // Restore bold placeholders
            boldPlaceholders.forEach((content, index) => {
                slack = slack.replace(`__BOLD_${index}__`, `*${content}*`);
            });

            // Convert strikethrough ~~text~~ to ~text~
            slack = slack.replace(/~~(.+?)~~/g, '~$1~');

            // Convert bullet lists (- or *) to • (but preserve indentation)
            slack = slack.replace(/^(\s*)[-*] (.+)$/gim, '$1• $2');

            // Convert links [text](url) to <url|text>
            slack = slack.replace(/\[([^\]]+)\]\(([^)]+)\)/g, '<$2|$1>');

            // Restore code blocks and inline code
            codeBlocks.forEach((code, index) => {
                slack = slack.replace(`__CODEBLOCK_${index}__`, code);
            });

            inlineCodes.forEach((code, index) => {
                slack = slack.replace(`__INLINECODE_${index}__`, code);
            });

            // Clean up extra blank lines (more than 2 consecutive)
            slack = slack.replace(/\n{3,}/g, '\n\n');

            slackOutput.textContent = slack;
        }

        async function copyToClipboard() {
            const text = slackOutput.textContent;

            if (!text || slackOutput.classList.contains('empty')) {
                return;
            }

            try {
                await navigator.clipboard.writeText(text);
                copyBtn.textContent = 'Copied!';
                copyBtn.classList.add('copied');

                setTimeout(() => {
                    copyBtn.textContent = 'Copy Text';
                    copyBtn.classList.remove('copied');
                }, 2000);
            } catch (err) {
                // Fallback for older browsers
                const textarea = document.createElement('textarea');
                textarea.value = text;
                textarea.style.position = 'fixed';
                textarea.style.opacity = '0';
                document.body.appendChild(textarea);
                textarea.select();
                document.execCommand('copy');
                document.body.removeChild(textarea);

                copyBtn.textContent = 'Copied!';
                copyBtn.classList.add('copied');

                setTimeout(() => {
                    copyBtn.textContent = 'Copy Text';
                    copyBtn.classList.remove('copied');
                }, 2000);
            }
        }

        async function copyAsHTML() {
            const markdown = markdownInput.value;

            if (!markdown.trim()) {
                return;
            }

            // Convert directly from markdown to HTML (not from Slack format)
            let html = markdown;

            // Protect code blocks first
            const codeBlocks = [];
            html = html.replace(/```[\s\S]*?```/g, (match) => {
                codeBlocks.push(match);
                return `__CODEBLOCK_${codeBlocks.length - 1}__`;
            });

            // Protect inline code
            const inlineCodes = [];
            html = html.replace(/`[^`]+`/g, (match) => {
                inlineCodes.push(match);
                return `__INLINECODE_${inlineCodes.length - 1}__`;
            });

            // Convert headings to HTML heading tags (before other formatting)
            html = html.replace(/^### (.*)$/gim, '<h3>$1</h3>');
            html = html.replace(/^## (.*)$/gim, '<h2>$1</h2>');
            html = html.replace(/^# (.*)$/gim, '<h1>$1</h1>');

            // Convert bold **text** to <strong>
            html = html.replace(/\*\*(.+?)\*\*/g, '<strong>$1</strong>');

            // Convert italic *text* to <em> (but not if it's part of bold)
            html = html.replace(/(?<!\*)\*([^*\n]+?)\*(?!\*)/g, '<em>$1</em>');

            // Convert strikethrough
            html = html.replace(/~~(.+?)~~/g, '<del>$1</del>');

            // Convert links
            html = html.replace(/\[([^\]]+)\]\(([^)]+)\)/g, '<a href="$2">$1</a>');

            // Convert blockquotes
            html = html.replace(/^> (.+)$/gim, '<blockquote>$1</blockquote>');

            // Convert lists - process line by line to handle properly
            const lines = html.split('\n');
            const processedLines = [];
            let inList = false;
            let listType = null;

            for (let i = 0; i < lines.length; i++) {
                const line = lines[i];
                const bulletMatch = line.match(/^(\s*)[-*] (.+)$/);
                const numberMatch = line.match(/^(\s*)\d+\. (.+)$/);

                if (bulletMatch) {
                    const content = bulletMatch[2];

                    if (!inList || listType !== 'ul') {
                        if (inList) processedLines.push(`</${listType}>`);
                        processedLines.push('<ul>');
                        inList = true;
                        listType = 'ul';
                    }
                    processedLines.push(`<li>${content}</li>`);
                } else if (numberMatch) {
                    const content = numberMatch[2];

                    if (!inList || listType !== 'ol') {
                        if (inList) processedLines.push(`</${listType}>`);
                        processedLines.push('<ol>');
                        inList = true;
                        listType = 'ol';
                    }
                    processedLines.push(`<li>${content}</li>`);
                } else {
                    if (inList) {
                        processedLines.push(`</${listType}>`);
                        inList = false;
                        listType = null;
                    }
                    processedLines.push(line);
                }
            }
            if (inList) {
                processedLines.push(`</${listType}>`);
            }
            html = processedLines.join('\n');

            // Restore code blocks
            codeBlocks.forEach((code, index) => {
                const codeContent = code.replace(/```/g, '').trim();
                html = html.replace(`__CODEBLOCK_${index}__`, `<pre><code>${codeContent.replace(/\n/g, '<br>')}</code></pre>`);
            });

            // Restore inline code
            inlineCodes.forEach((code, index) => {
                const codeContent = code.replace(/`/g, '');
                html = html.replace(`__INLINECODE_${index}__`, `<code>${codeContent}</code>`);
            });

            // Convert remaining newlines to <br> (but not inside block elements)
            html = html.replace(/\n/g, '<br>');

            // Clean up: remove <br> tags that are inside/after block elements
            html = html.replace(/(<\/h[1-6]>)<br>/gi, '$1');
            html = html.replace(/(<\/li>)<br>/gi, '$1');
            html = html.replace(/(<\/blockquote>)<br>/gi, '$1');
            html = html.replace(/(<\/ul>)<br>/gi, '$1');
            html = html.replace(/(<\/ol>)<br>/gi, '$1');
            html = html.replace(/(<h[1-6]>)<br>/gi, '$1');
            html = html.replace(/(<ul>)<br>/gi, '$1');
            html = html.replace(/(<ol>)<br>/gi, '$1');
            html = html.replace(/(<li>)<br>/gi, '$1');
            html = html.replace(/(<blockquote>)<br>/gi, '$1');

            const button = document.getElementById('copyHtmlBtn');
            const originalText = button.textContent;

            // Get plain text version (Slack format) for fallback
            const plainText = slackOutput.classList.contains('empty') ? markdown : slackOutput.textContent;

            try {
                // Copy as HTML using Clipboard API
                const clipboardItem = new ClipboardItem({
                    'text/plain': new Blob([plainText], { type: 'text/plain' }),
                    'text/html': new Blob([html], { type: 'text/html' })
                });

                await navigator.clipboard.write([clipboardItem]);
                button.textContent = 'Copied!';

                setTimeout(() => {
                    button.textContent = originalText;
                }, 2000);
            } catch (err) {
                // Fallback: just copy as text
                await copyToClipboard();
                alert('HTML clipboard not supported in this browser. Copied as plain text instead.');
            }
        }

        function clearAll() {
            markdownInput.value = '';
            slackOutput.textContent = 'Slack-formatted text will appear here...';
            slackOutput.classList.add('empty');
            markdownInput.focus();
        }

        function loadExample() {
            const example = `# Meeting Notes

## Action Items

- **Review** the proposal by Friday
- *Follow up* with the team
- ~~Old task~~ (completed)

## Code Example

Here's some \`inline code\` and a block:

\`\`\`javascript
function greet(name) {
  return \`Hello, \${name}!\`;
}
\`\`\`

## Links

Check out [this article](https://example.com/article) for more info.

## Quote

> "The best way to predict the future is to invent it."
> — Alan Kay

## Numbered List

1. First step
2. Second step
3. Third step`;

            markdownInput.value = example;
            convertMarkdownToSlack();
        }

        // Initial focus
        markdownInput.focus();
    </script>
</body>

</html>